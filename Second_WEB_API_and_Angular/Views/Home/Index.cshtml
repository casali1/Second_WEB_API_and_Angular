
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
    <head>
        <meta name="viewport" content="width=device-width" />
        <title>Index</title>
    </head>
    <body>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.9/angular.min.js"></script>
        <script type="text/javascript">

            var app = angular.module('MyApp', [])

            app.controller('MyController', function ($scope, $http, $window) {

                $scope.IsVisible = false;

                $scope.Search = function () {

                    var customer = '{Name: "' + $scope.Prefix + '" }';

                    var post = $http({
                        method: "POST",
                        url: "/api/AjaxAPI/AjaxMethod",
                        dataType: 'json',
                        data: customer,
                        headers: { "Content-Type": "application/json" }
                    });

                    post.success(function (data, status) {
                        $scope.Customers = data;
                        $scope.IsVisible = true;
                    });

                    post.error(function (data, status) {
                        $window.alert(data.Message);
                    });
                }
            });

        </script>
        <div ng-app="MyApp" ng-controller="MyController">

            Name:
            <input type="text" ng-model="Prefix" />
            <input type="button" value="Submit" ng-click="Search()" />
            <hr />

            <table cellpadding="0" cellspacing="0" ng-show="IsVisible">
                <tr>
                    <th>Customer Id</th>
                    <th> | | </th>
                    <th>Name</th>
                    <th> | | </th>
                    <th>Country</th>
                </tr>
                <tbody ng-repeat="m in Customers">
                    <tr>
                        <td>{{m.ID}}</td>
                        <th> | | </th>
                        <td>{{m.Name}}</td>
                        <th> | | </th>
                        <td>{{m.Country}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>
</html>
